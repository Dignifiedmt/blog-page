
<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dignity Tech Journey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .post-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        video {
            max-height: 48rem;
            width: 100%;
            object-fit: cover;
        }
        .error-message {
            display: none;
            color: red;
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-50">
    <header class="bg-gradient-to-r from-indigo-600 to-blue-500 text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <div class="flex justify-center items-center mb-3">
                <i class="fa-solid fa-desktop text-5xl mr-4"></i>
                <h1 class="text-4xl md:text-5xl font-bold">Dignity Tech Journey</h1>
            </div>
            <p class="text-lg md:text-xl max-w-2xl mx-auto mb-6">Hey there! I'm thrilled to kick off this blog and share my adventures in the world of tech. From coding experiments to exploring new tools and trends, this space will capture my learning, projects, and insights. Whether you're a fellow tech enthusiast or just curious, join me as I dive into the exciting, ever-evolving world of technology. Let's learn, build, and grow together!</p>
            <img src="hero.png" alt="Hero Profile" class="mx-auto rounded-full w-32 h-32 shadow-lg">
        </div>
    </header>

    <div class="container mx-auto p-4 max-w-6xl">
        <div class="mb-6">
            <input type="text" id="search" placeholder="Search articles by title or content..." class="w-full p-3 border border-gray-300 rounded-md focus:border-indigo-500 focus:ring-indigo-500 shadow-sm">
        </div>

        <form id="postForm" class="bg-white p-6 rounded-lg shadow-lg mb-8">
            <input type="hidden" id="postId" value="">
            <div class="mb-4">
                <label for="title" class="block text-sm font-medium text-gray-700">Article Title</label>
                <input type="text" id="title" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="e.g., My Journey with JavaScript Frameworks" required>
            </div>
            <div class="mb-4">
                <label for="content" class="block text-sm font-medium text-gray-700">Article Content</label>
                <textarea id="content" rows="6" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="Share your tech journey or insights..." required></textarea>
            </div>
            <div class="mb-4">
                <label for="mediaFile" class="block text-sm font-medium text-gray-700">Upload Image/Video (optional, max 25MB)</label>
                <input type="file" id="mediaFile" accept="image/*,video/*" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
            </div>
            <div id="errorMessage" class="error-message"></div>
            <button type="submit" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Add Article</button>
        </form>

        <div id="posts" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div>

    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm">&copy; 2025 Dignity Tech Journey. Sharing my tech journey and spreading tech awareness.</p>
            <div class="mt-2 flex justify-center space-x-4">
                <a href="https://www.facebook.com/devkhadijamtasiu" target="_blank" class="text-indigo-300 hover:text-indigo-100"><i class="fab fa-facebook-f mr-1"></i>Facebook</a>
                <a href="https://x.com/Dignitymt?s=09" target="_blank" class="text-indigo-300 hover:text-indigo-100"><i class="fab fa-x-twitter mr-1"></i>X</a>
                <a href="https://linkedin.com/in/khadija-muhammad-tasiu-407240288" target="_blank" class="text-indigo-300 hover:text-indigo-100"><i class="fab fa-linkedin-in mr-1"></i>LinkedIn</a>
                <a href="https://github.com/Dignifiedmt" target="_blank" class="text-indigo-300 hover:text-indigo-100"><i class="fab fa-github mr-1"></i>GitHub</a>
            </div>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getAnalytics, logEvent } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp, deleteDoc, updateDoc, doc } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBI8tQRf6qJZjB4liFEUnywBa5Xktprbm4",
            authDomain: "blog-page-b5206.firebaseapp.com",
            projectId: "blog-page-b5206",
            storageBucket: "blog-page-b5206.firebasestorage.app",
            messagingSenderId: "957108154087",
            appId: "1:957108154087:web:45019af09c499ede78bc42",
            measurementId: "G-C2PVCE74ZE"
        };

        let app, db, analytics;
        try {
            app = initializeApp(firebaseConfig);
            analytics = getAnalytics(app);
            db = getFirestore(app);
            logEvent(analytics, 'page_view', { page_title: 'Dignity Tech Journey' });
            console.log('Firebase initialized successfully');
        } catch (error) {
            console.error('Firebase initialization error:', error.message, error.code);
            showError('Cannot connect to Firebase. Check your setup.');
        }

        const postsRef = db ? collection(db, 'posts') : null;

        let allPosts = [];

        const defaultSvg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-full h-48 text-gray-400">
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
            <line x1="8" y1="21" x2="16" y2="21"></line>
            <line x1="12" y1="17" x2="12" y2="21"></line>
        </svg>`;

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.style.display = 'block';
            errorDiv.textContent = message;
            setTimeout(() => { errorDiv.style.display = 'none'; }, 5000);
        }

        window.addEventListener('online', () => console.log('Network online'));
        window.addEventListener('offline', () => {
            console.warn('Network offline');
            showError('You are offline. Check your internet connection.');
        });

        async function uploadToCloudinary(file) {
            const cloudName = 'YOUR_CLOUDINARY_CLOUD_NAME'; // Replace with your Cloudinary Cloud Name
            const uploadPreset = 'blog-page'; // Your provided preset
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', uploadPreset);

            try {
                const response = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/auto/upload`, {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                if (data.secure_url) {
                    return { url: data.secure_url, type: file.type.startsWith('video/') ? 'video' : 'image' };
                } else {
                    throw new Error('Cloudinary upload failed: ' + (data.error?.message || 'Unknown error'));
                }
            } catch (error) {
                throw error;
            }
        }

        function displayPosts(posts) {
            const postsContainer = document.getElementById('posts');
            postsContainer.innerHTML = '';
            if (posts.length === 0) {
                postsContainer.innerHTML = '<p class="text-gray-500 text-center col-span-full">No posts found. Add your first article!</p>';
            }
            posts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.classList.add('post-card', 'bg-white', 'p-6', 'rounded-lg', 'shadow-md');
                const mediaSrc = post.mediaUrl;
                const isVideo = post.mediaType === 'video';
                let mediaHtml = '';
                if (mediaSrc) {
                    if (isVideo) {
                        mediaHtml = `<video controls src="${mediaSrc}" class="w-full h-48 rounded-t-lg mb-4"></video>`;
                    } else {
                        mediaHtml = `<img src="${mediaSrc}" alt="${post.title}" class="w-full h-48 object-cover rounded-t-lg mb-4">`;
                    }
                } else {
                    mediaHtml = defaultSvg;
                }
                postElement.innerHTML = `
                    ${mediaHtml}
                    <h2 class="text-xl font-semibold mb-2 text-gray-800">${post.title}</h2>
                    <p class="text-gray-600 mb-4 line-clamp-3">${post.content}</p>
                    <p class="text-sm text-gray-500 mb-4">Posted on: ${post.timestamp ? new Date(post.timestamp.seconds * 1000).toLocaleString() : 'N/A'}</p>
                    <div class="flex justify-end space-x-2">
                        <button class="edit-btn bg-blue-500 text-white py-1 px-3 rounded hover:bg-blue-600 text-sm" data-id="${post.id}" data-media="${post.mediaUrl || ''}">Edit</button>
                        <button class="delete-btn bg-red-500 text-white py-1 px-3 rounded hover:bg-red-600 text-sm" data-id="${post.id}" data-media="${post.mediaUrl || ''}">Delete</button>
                    </div>
                `;
                postsContainer.appendChild(postElement);
            });
        }

        if (postsRef) {
            const q = query(postsRef, orderBy('timestamp', 'desc'));
            onSnapshot(q, (snapshot) => {
                allPosts = [];
                snapshot.forEach((doc) => {
                    allPosts.push({ id: doc.id, ...doc.data() });
                });
                console.log('Fetched posts:', allPosts);
                const searchTerm = document.getElementById('search').value.toLowerCase();
                const filteredPosts = filterPosts(allPosts, searchTerm);
                displayPosts(filteredPosts);
            }, (error) => {
                console.error('Firestore snapshot error:', error.message, error.code);
                showError('Cannot load posts: ' + error.message);
                if (error.code === 'failed-precondition') {
                    showError('Firestore API may be disabled. Enable it in Google Cloud Console.');
                } else if (error.code === 'permission-denied') {
                    showError('Check Firestore security rules in Firebase Console.');
                }
            });
        } else {
            showError('Firestore not available. Check Firebase configuration.');
        }

        function filterPosts(posts, term) {
            if (!term) return posts;
            return posts.filter(post => 
                post.title.toLowerCase().includes(term) || 
                post.content.toLowerCase().includes(term)
            );
        }

        document.getElementById('search').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filteredPosts = filterPosts(allPosts, term);
            displayPosts(filteredPosts);
        });

        document.getElementById('posts').addEventListener('click', async (e) => {
            if (!db) {
                showError('Firestore not available.');
                return;
            }
            if (e.target.classList.contains('edit-btn')) {
                const id = e.target.dataset.id;
                const post = allPosts.find(p => p.id === id);
                if (post) {
                    document.getElementById('postId').value = post.id;
                    document.getElementById('title').value = post.title;
                    document.getElementById('content').value = post.content;
                    document.getElementById('mediaFile').value = '';
                    document.querySelector('#postForm button').textContent = 'Update Article';
                }
            } else if (e.target.classList.contains('delete-btn')) {
                const id = e.target.dataset.id;
                if (confirm('Are you sure you want to delete this article?')) {
                    try {
                        // Note: Cloudinary deletion requires signed API calls, omitted for simplicity
                        await deleteDoc(doc(db, 'posts', id));
                        console.log('Post deleted:', id);
                        logEvent(analytics, 'post_deleted', { post_id: id });
                    } catch (error) {
                        console.error('Error deleting article:', error.message, error.code);
                        showError('Failed to delete article: ' + error.message);
                    }
                }
            }
        });

        document.getElementById('postForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!db) {
                showError('Firestore not available.');
                return;
            }
            const postId = document.getElementById('postId').value;
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            const mediaFile = document.getElementById('mediaFile').files[0];

            try {
                let mediaUrl = null;
                let mediaType = null;

                if (mediaFile) {
                    const maxSize = 25 * 1024 * 1024; // 25MB
                    if (mediaFile.size > maxSize) {
                        showError('File size exceeds 25MB limit.');
                        return;
                    }
                    const uploadResult = await uploadToCloudinary(mediaFile);
                    mediaUrl = uploadResult.url;
                    mediaType = uploadResult.type;
                    console.log('Media uploaded to Cloudinary:', mediaUrl);
                }

                if (postId) {
                    await updateDoc(doc(db, 'posts', postId), {
                        title,
                        content,
                        mediaUrl,
                        mediaType
                    });
                    console.log('Post updated:', postId);
                    logEvent(analytics, 'post_updated', { title });
                } else {
                    await addDoc(postsRef, {
                        title,
                        content,
                        mediaUrl,
                        mediaType,
                        timestamp: serverTimestamp()
                    });
                    console.log('Post added:', title);
                    logEvent(analytics, 'post_added', { title });
                }

                document.getElementById('postId').value = '';
                document.getElementById('title').value = '';
                document.getElementById('content').value = '';
                document.getElementById('mediaFile').value = '';
                document.querySelector('#postForm button').textContent = 'Add Article';
            } catch (error) {
                console.error('Error saving article:', error.message, error.code);
                showError('Failed to save article: ' + error.message);
                if (error.code === 'failed-precondition') {
                    showError('Firestore API may be disabled. Enable it in Google Cloud Console.');
                } else if (error.code === 'permission-denied') {
                    showError('Check Firestore security rules in Firebase Console.');
                } else if (error.message.includes('Cloudinary')) {
                    showError('Cloudinary upload failed. Check Cloud Name and Upload Preset.');
                }
            }
        });
    </script>
</body>
</html>
